# Глава 64. Boost.Serialization

## Содержание
- Архив
- Указатели и ссылки
- Сериализация иерархии классов объектов
- Оберточные функции для оптимизации

Библиотека Boost.Serialization позволяет преобразовать объекты в программе C++ в последовательности байтов, которые могут быть сохранены и загружены для восстановления объектов. Существуют различные форматы данных, доступные для определения правил генерации последовательности байтов. Все форматы, поддерживаемые Boost.Serialization предназначены только для использования с этой библиотекой. Например, формат XML, разработанный для Boost.Serialization, не должен использоваться для обмена данными с программами, которые не используют Boost.Serialization. Единственное преимущество формата XML является то, что он может сделать отладку проще, так как объекты C++ сохраняются в удобном для чтения формате.

***

# Архив

Основной концепцией Boost.Serialization является архив. Архив представляет собой последовательность байтов, которые представляют собой сериализованные C++ объекты. Объекты могут быть добавлены в архив для сериализации, а затем загружены из архива. Для того, чтобы восстановить ранее сохраненные объекты C++, теми же типами считаются.

`Пример 64.1. Используется boost::archive::text_oarchive`
``` c++
#include <boost/archive/text_oarchive.hpp>
#include <iostream>

using namespace boost::archive;

int main()
{
  text_oarchive oa{std::cout};
  int i = 1;
  oa << i;
}
```
Boost.Serialization обеспечивает архив-классы, например Boost::архив::text_oarchive, который определен в Boost/archive/text_oarchive.hpp. Этот класс дает возможность сериализовать объекты в текстовый поток. С Boost 1.56.0, пример 64.1 вернет **22 serialization::archive 11 1** в стандартный выходной поток.

Как видно, объект oa типа Boost::archive::text_oarchive может быть использован как поток для сериализации переменной при помощи оператора <<. Однако архивы не должны рассматриваться как обычные потоки, храненящие произвольные данные. Для восстановления данных, Вы должны открыть его, как вы храните его, используя те же типы данных в том же порядке. Пример 64.2 сериализует и возвращает переменную типа int.
`Пример 64.2. Используется boost::archive::text_iarchive`
```c++
#include <boost/archive/text_oarchive.hpp>
#include <boost/archive/text_iarchive.hpp>
#include <iostream>
#include <fstream>

using namespace boost::archive;

void save()
{
  std::ofstream file{"archive.txt"};
  text_oarchive oa{file};
  int i = 1;
  oa << i;
}

void load()
{
  std::ifstream file{"archive.txt"};
  text_iarchive ia{file};
  int i = 0;
  ia >> i;
  std::cout << i << '\n';
}

int main()
{
  save();
  load();
}```
